import{_ as a,c as e,o as t,a5 as s}from"./chunks/framework.-i2sbza6.js";const b=JSON.parse('{"title":"HttpCanary-Android","description":"","frontmatter":{},"headers":[],"relativePath":"zh/guide/import_https/httpcanary.md","filePath":"zh/guide/import_https/httpcanary.md","lastUpdated":1692363842000}'),i={name:"zh/guide/import_https/httpcanary.md"},l=s(`<h1 id="httpcanary-android" tabindex="-1">HttpCanary-Android <a class="header-anchor" href="#httpcanary-android" aria-label="Permalink to &quot;HttpCanary-Android&quot;">​</a></h1><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>不知为什么，有时失败。部分数据请求失败导致无法到发送登陆请求这一步。</p><p>建议开启白名单模式(whitelist)，仅目标网址的域名（<code>game.fate-go.jp</code>, <code>line*-fate.bilibiligame.net</code>）进行抓包解密。</p><p>还是不行就用<a href="./charles">Charles</a>方法吧。</p><p>我没试过，用不成功就找别的方法，问我也不会。</p></div><p>总结：适用于 Android，无需电脑(或仅需第一次 adb 安装证书)，可用于国服/台服。</p><h2 id="android-版本" tabindex="-1">Android 版本 <a class="header-anchor" href="#android-版本" aria-label="Permalink to &quot;Android 版本&quot;">​</a></h2><p>根据安卓版本不同，证书安装步骤有些许不同。</p><ol><li>&lt;=6: 无需 root，安装至用户证书即可（蓝 MuMu 模拟器即可！）</li><li>7-10: 需 root，使用 HttpCanary 自带的安装证书功能安装至用户证书，adb 移动至系统证书或 Magisk+JustTrustMe 模块实现</li><li>11+: 在 HttpCanary 中导出 pem 证书，在系统设置中手动安装，再 adb 或 Magisk 移动证书至系统证书。或导出.0 证书，直接复制到系统证书。</li><li>12+: 似乎更麻烦了，自行研究 ╮(╯▽╰)╭</li><li>也有使用各种虚拟机等机制将 HttpCanary 及 FGO 应用安装在虚拟机内再抓包的，无需 root，请自行研究</li></ol><h2 id="adb" tabindex="-1">adb <a class="header-anchor" href="#adb" aria-label="Permalink to &quot;adb&quot;">​</a></h2><ol><li><p>打开手机开发者选项和调试模式，USB 连接电脑</p></li><li><p>下载 adb, 将 adb 路径添加至 Path 环境变量中(可选):</p><ul><li>谷歌官方: <a href="https://developer.android.com/studio/releases/platform-tools" target="_blank" rel="noreferrer">https://developer.android.com/studio/releases/platform-tools</a></li><li><a href="https://adbshell.com/downloads" target="_blank" rel="noreferrer">https://adbshell.com/downloads</a></li></ul></li><li><p>打开 CMD/PowerShell, 确保 adb 或./adb 可用，执行以下命令</p></li><li><p>USB 连接手机（adb 会自动连接?），或模拟器 <code>adb connect 127.0.0.1:xxxx</code></p><p>不同模拟器的端口 xxxx 不同，百度之或参考下方。真机连接后应该会自动识别无需手动连接。注意请只连接一个 Android 设备，否则各命令需要指定目标设备。 <code>adb devices</code>可查看已连接设备。</p></li><li><p>执行以下命令</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>adb shell</span></span>
<span class="line"><span>su</span></span>
<span class="line"><span>mount -o rw,remount /</span></span>
<span class="line"><span>cp -f /data/data/com.guoshi.httpcanary/cache/HttpCanary.pem /system/etc/security/cacerts/87bc3517.0</span></span>
<span class="line"><span>chmod 644 /system/etc/security/cacerts/87bc3517.0</span></span>
<span class="line"><span>touch /data/data/com.guoshi.httpcanary/cache/HttpCanary.jks</span></span>
<span class="line"><span>chmod 600 /data/data/com.guoshi.httpcanary/cache/HttpCanary.jks</span></span></code></pre></div></li><li><p>打开 HttpCanary，开始抓包，保存目标请求的响应。</p></li></ol><h3 id="常见模拟器端口" tabindex="-1">常见模拟器端口 <a class="header-anchor" href="#常见模拟器端口" aria-label="Permalink to &quot;常见模拟器端口&quot;">​</a></h3><p>摘自互联网，不同模拟器有多种版本，也可能不同，仅供参考 ╮(╯▽╰)╭</p><ul><li>网易 MuMu 7555</li><li>夜神 62001</li><li>逍遥 21503</li><li>蓝叠 5555 (ps:新蓝叠似乎根本没有证书/网络相关设置入口</li><li>雷电 5555</li><li>天天 5037</li><li>腾讯手游助手 5555</li></ul><h2 id="magisk-框架-justtrustme-类模块" tabindex="-1">Magisk 框架+JustTrustMe 类模块 <a class="header-anchor" href="#magisk-框架-justtrustme-类模块" aria-label="Permalink to &quot;Magisk 框架+JustTrustMe 类模块&quot;">​</a></h2><p>关于 Magisk 安装可参考<a href="https://sekibetu.com/sniff01.html" target="_blank" rel="noreferrer">Sekibetu 教程</a></p><p>目前（应该）只需能移动用户证书至系统证书的模块即可，cert-pinning 目前无要求（已使用第三方 apk）</p><ol><li><p>安装 Magisk</p></li><li><p>Magisk 内安装<a href="https://github.com/SekiBetu/JustTrustMe/releases" target="_blank" rel="noreferrer">JustTrustMe</a>或<a href="https://github.com/NVISOsecurity/MagiskTrustUserCerts/releases" target="_blank" rel="noreferrer">MagiskTrustUserCerts</a>模块</p></li><li><p>HttpCanary 安装证书至用户证书</p></li><li><p>重启手机，模块会自动安装证书至系统证书</p></li><li><p>(Android 11+?) 创建文件并赋予 600 权限(如 adb 的最后一步)让 HttpCanary 识别证书已安装</p><p><code>/data/data/com.guoshi.httpcanary/cache/HttpCanary.jks</code></p></li><li><p>开始抓包</p></li></ol><h2 id="目标请求" tabindex="-1">目标请求 <a class="header-anchor" href="#目标请求" aria-label="Permalink to &quot;目标请求&quot;">​</a></h2><p>仅需 FGO 登录时的请求，其网址为:</p><ul><li>国服: 其中<code>line3-s2-ios-fate</code>随账号所在服务器(iOS/b 服/渠道服)以及所在地理位置等有所不同，最重要的是<code>_key=toplogin</code></li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>https://line3-s2-ios-fate.bilibiligame.net/rongame_beta//rgfate/60_1001/ac.php?_userId=xxxx&amp;_key=toplogin</span></span></code></pre></div><ul><li>台服: 与国服类似，域名格式<code>https://line3-s1-all.fate-go.com.tw</code>，由于无台服账号，待确认</li><li>日服:</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>https://game.fate-go.jp/login/top?_userId=xxxx</span></span></code></pre></div><ul><li>美服:</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>https://game.fate-go.us/login/top?_userId=xxxx</span></span></code></pre></div><h2 id="emmmm" tabindex="-1">emmmm <a class="header-anchor" href="#emmmm" aria-label="Permalink to &quot;emmmm&quot;">​</a></h2><p>总之网上多搜搜 ╮(╯▽╰)╭ 我也没有 root 的手机，也没试过那么多种安卓版本。</p><p>蓝 Mumu 模拟器(Android 6)无论 HttpCanary 还是 Charles 都只要安装用户证书就可以开始抓包，不想折腾的就用这个吧。</p>`,26),p=[l];function o(n,r,d,c,h,u){return t(),e("div",null,p)}const g=a(i,[["render",o]]);export{b as __pageData,g as default};
