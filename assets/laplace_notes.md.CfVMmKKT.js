import{_ as e,c as a,o as t,a5 as i}from"./chunks/framework.-i2sbza6.js";const f=JSON.parse('{"title":"Laplace Dev Notes","description":"","frontmatter":{},"headers":[],"relativePath":"laplace/notes.md","filePath":"laplace/notes.md","lastUpdated":1707362395000}'),s={name:"laplace/notes.md"},n=i(`<h1 id="laplace-dev-notes" tabindex="-1">Laplace Dev Notes <a class="header-anchor" href="#laplace-dev-notes" aria-label="Permalink to &quot;Laplace Dev Notes&quot;">​</a></h1><details class="details custom-block"><summary>Table of Contents</summary><nav class="table-of-contents"><ul><li><a href="#switching-targets">Switching Targets</a><ul><li><a href="#selecting-the-next-target">Selecting the next target</a></li><li><a href="#u-olga-marie-s-aoe-card">U-Olga Marie&#39;s AOE Card</a></li></ul></li><li><a href="#dot-damage-mechanism">DOT Damage Mechanism</a></li><li><a href="#overkill-bug-bug">Overkill Bug Bug</a></li><li><a href="#multiple-class-affinity-buffs">Multiple Class Affinity Buffs</a></li><li><a href="#multiple-np-card-type-change-buff">Multiple NP Card Type Change Buff</a></li><li><a href="#revenge-target">Revenge Target</a></li><li><a href="#aŋra-mainiiu-s-np">Aŋra Mainiiu&#39;s NP</a></li><li><a href="#about-hp-bars-related-scripts">About HP Bars related scripts</a></li></ul></nav></details><h2 id="switching-targets" tabindex="-1">Switching Targets <a class="header-anchor" href="#switching-targets" aria-label="Permalink to &quot;Switching Targets&quot;">​</a></h2><h3 id="selecting-the-next-target" tabindex="-1">Selecting the next target <a class="header-anchor" href="#selecting-the-next-target" aria-label="Permalink to &quot;Selecting the next target&quot;">​</a></h3><p>For regular quests, the next target is determined based on on-field order.</p><p>If <code>QuestFlag.immediateEnemyDisapper</code> is present, the next target is determined based on uniqueId.</p><h3 id="u-olga-marie-s-aoe-card" tabindex="-1">U-Olga Marie&#39;s AOE Card <a class="header-anchor" href="#u-olga-marie-s-aoe-card" aria-label="Permalink to &quot;U-Olga Marie&#39;s AOE Card&quot;">​</a></h3><p>NP Card or AOE Card (U-Olga Marie&#39;s Buster &amp; Extra) will force a target switch (resulting in death animation). This applies both before and after the card.</p><p>E.g. U-Olga Marie executing a BAQ Chain will result in target switch three times:</p><ol><li>After Buster, play death animation if any enemy death, switch targets</li><li>After Arts &amp; Quick but before Extra, play death animation and switch targets again</li><li>After Extra, switch the third time</li></ol><p>The takeaway is that this may affect U-Olga Marie&#39;s NP refund if the Buster card kills the enemy before Arts.</p><h2 id="dot-damage-mechanism" tabindex="-1">DOT Damage Mechanism <a class="header-anchor" href="#dot-damage-mechanism" aria-label="Permalink to &quot;DOT Damage Mechanism&quot;">​</a></h2><p>At the end of the turn, first record the current hp as <code>X</code>, then applies HOT, then DOT. If DOT would kill the servant (hp &lt;= 0), then:</p><ul><li>if there is enemy (including backup) available, applies normal DOT damage.</li><li>if all enemies (including backup) are eliminated, cap the DOT damage as <code>X - 1</code>, thus the servant would live.</li></ul><p>For example, suppose we have a setup where Babbage equiping a 1HP Guts CE then uses his skill 3 (300 DOT), followed by Van Gogh&#39;s skill 2 (100 DOT and 300 HOT) and Gong&#39;s NP (also Gong&#39;s skill 1 not taunting Babbage), then:</p><ul><li>if there is enemy (including backup) available, Babbage would end up with <code>1 + 300 - 400 = -99 HP</code> and die</li><li>if all enemies (including backup) are eliminated, Babbage would end up with <code>1 + 300 - 0 = 301 HP</code> and live (since DOT damage got capped at <code>X - 1</code> where <code>X = 1</code>)</li></ul><p>The takeaway is if you kill all enemies in the current wave you can help servants with lethal DOT to live one more turn.</p><h2 id="overkill-bug-bug" tabindex="-1">Overkill Bug Bug <a class="header-anchor" href="#overkill-bug-bug" aria-label="Permalink to &quot;Overkill Bug Bug&quot;">​</a></h2><p>Overkill bug refers to the bug that by doing enough damage in a single turn you can gain overkill NP (* 1.5) even if it&#39;s not actually an overkill (only applies to command cards). This got preserved as a feature.</p><p>Triggering enemy deathRattle or gutsFunction would reset accumulation damage thus disabling overkill bug.</p><h2 id="multiple-class-affinity-buffs" tabindex="-1">Multiple Class Affinity Buffs <a class="header-anchor" href="#multiple-class-affinity-buffs" aria-label="Permalink to &quot;Multiple Class Affinity Buffs&quot;">​</a></h2><p>E.g. if Reines NP (negates DEF disadvantage) and Kama skill 3 (advantage against Alter Ego) both applies, and somehow an enemy Alter Ego applies ATK advantage against Assassin, what would be the final affinity if this Alter Ego attacks Kama?</p><p>This depends on the order of Kama&#39;s skill 3 &amp; Reines&#39; NP.</p><ul><li>First, Defender&#39;s Class Affinity Buff would override that of the attacker</li><li><strong>Whichever gets applied first gets higher priority</strong>, so if Kama uses skill 3 first then the affinity would be 0.5, otherwise it would be 1</li></ul><h2 id="multiple-np-card-type-change-buff" tabindex="-1">Multiple NP Card Type Change Buff <a class="header-anchor" href="#multiple-np-card-type-change-buff" aria-label="Permalink to &quot;Multiple NP Card Type Change Buff&quot;">​</a></h2><p>The last chosen card type gets priority.</p><h2 id="revenge-target" tabindex="-1">Revenge Target <a class="header-anchor" href="#revenge-target" aria-label="Permalink to &quot;Revenge Target&quot;">​</a></h2><p>Related Buffs: selfturnendFunction (turn end), delayFunction (after X turns), gutsFunction, damageFunction (when defending), deadFunction. Each trigger skill finds its own target.</p><p>Damage type: Command Card, Np Card, HP loss, DOT, damageValue (script damage)</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Not entirely confirmed</p></div><p>Should be based on the following order:</p><ol><li><p>Selecting a revenge target</p><p>When the buffs above activates, will target the last entity that attacked the current servant (regardless whether that&#39;s an ally or not on field or already dead):</p><ul><li>Excludes self</li><li>If <code>DataVals.OpponentOnly</code> is specified, then will only target enemy</li></ul><p>If there is no valid revenge target, then select a random enemy. In Laplace, this means the selected enemy.</p></li><li><p>Selecting the actual target based on <code>func.funcTargetType</code></p><ul><li><code>enemy</code>: a single enemy, if a valid revenge target exists from the previous step, then select that target</li><li><code>enemyOneNoDamageNoAction</code>: same as above, except this one only activates when taking damage</li><li><code>enemyOther</code>/<code>enemyOtherFull</code>: targets all enemies excluding the revenge target (all enemies if revenge target is an ally)</li></ul></li></ol><h2 id="aŋra-mainiiu-s-np" tabindex="-1">Aŋra Mainiiu&#39;s NP <a class="header-anchor" href="#aŋra-mainiiu-s-np" aria-label="Permalink to &quot;Aŋra Mainiiu&#39;s NP&quot;">​</a></h2><p>Based on current testing result, Aŋra Mainiiu will record all damages after his NP, which will get canceled out by healing (negative damage).</p><p>Note that:</p><ul><li>the recorded damage would not be negative, thus having a minimum of 0.</li><li>servants have a minimum HP of 0, so if one has 500 HP and takes a billion damage, the recorded damage would be 500.</li><li>DOT, force instant death (Gong&#39;s NP), and damages done by self are not recorded.</li><li>HOT would cancel out recorded damage (however, right now there is no meaningful way to test this).</li><li>Guts count as heals, thus canceling out the recorded damage. However, the healing amount is <code>gutsHp - 1</code> (so a guts of 3000 HP counts as 2999 healing).</li></ul><p>Tips: most of the time you can just do the calculation by writing down Aŋra Mainiiu&#39;s HP at the start of the enemy turn. The recorded damage (not multiplying by NP&#39;s rate) is <code>Aŋra Mainiiu&#39;s HP at the start of enemy turn - Aŋra Mainiiu&#39;s HP at the end of enemy turn + number of times Guts applied</code>.</p><h2 id="about-hp-bars-related-scripts" tabindex="-1">About HP Bars related scripts <a class="header-anchor" href="#about-hp-bars-related-scripts" aria-label="Permalink to &quot;About HP Bars related scripts&quot;">​</a></h2><ul><li><code>EnemyScript.shiftPosition</code>: starting value of <code>shiftDeckIndex</code>, <strong>default to -1</strong>. When this value is set, enemy HP bars would get partially hidden based on the value. For example, if an enemy has five npcId in <code>EnemyScript.shift</code> (6 HP bars in total), if shiftPosition = 1. then two HP bars will be hidden, and only three extra HP bars will be shown.</li><li><code>EnemyScript.dispBreakDisp</code>: make the enemy to start with empty hp bars, default to 0.</li><li><code>FuncType.breakGaugeUp/Down</code>: Used to add / remove HP bars of enemy via scripted events. Note that if <code>DataVals.ChangeMaxBreakGauge</code> is set, then the final display would be a little different. For example if right now the hp bar is (3/5) and <code>DataVals.ChangeMaxBreakGauge</code> is set, then after <code>breakGaugeUp</code> it would arrive at (4/6) instead of (4/5).</li></ul><p>E.g.: <a href="https://apps.atlasacademy.io/db/JP/quest/94091502/1" target="_blank" rel="noreferrer">FSR Event Main Story 2-1 Ushi Gozen</a> base enemy npcId=100, EnemyScript:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;npcId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;script&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;shift&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">101</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">102</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">103</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">104</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;shiftPosition&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;dispBreakShift&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><table><thead><tr><th>idx</th><th><strong>Step</strong></th><th><strong>lowLimitShift</strong></th><th><strong>shiftDeckIndex</strong></th><th><strong>curNpcId</strong></th><th><strong>Bars</strong></th></tr></thead><tbody><tr><td>1</td><td>init</td><td>0</td><td>-1</td><td>100</td><td>◆◆◆◆<br>5/5</td></tr><tr><td>2</td><td>shiftPosition=2</td><td>0+(2+1)=3</td><td>-1+(2+1)=2</td><td>103</td><td>◆<br>2/2</td></tr><tr><td>3</td><td>dispBreakShift=1</td><td>3</td><td>2+1=3</td><td>104</td><td>◇<br>1/2</td></tr><tr><td>4</td><td>breakGaugeUp(2)<br>+ChangeMaxBreakGauge</td><td>3-2=1</td><td>3-2=1</td><td>102</td><td>◆◆◇<br>3/4</td></tr><tr><td>5</td><td>breakGaugeUp(1)</td><td>1</td><td>1-1=0</td><td>101</td><td>◆◆◆<br>4/4</td></tr></tbody></table><blockquote><p>Step 4 is Yui Shousetsu&#39;s Master skill. Step 5 is not actually in this quest, just here to demonstrate the effect when ChangeMaxBreakGauge is not set.</p></blockquote>`,43),l=[n];function r(d,o,h,p,c,u){return t(),a("div",null,l)}const m=e(s,[["render",r]]);export{f as __pageData,m as default};
